---
- block:
  - name: center new windows
    dconf:
      key: '/org/gnome/mutter/center-new-windows'
      value: 'true'
      state: present
  - name: enable compose key
    dconf:
      key: '/org/gnome/desktop/input-sources/xkb-options'
      value: "['caps:shift_nocancel', 'compose:caps']"
  - name: Disable conflicting keyboard shortcut switch to workspace left
    dconf:
      key: "/org/gnome/desktop/wm/keybindings/switch-to-workspace-left"
      value: "['<Super>Page_Up', '<Super><Alt>Left']"
  - name: Disable conflicting keyboard shortcut switch to workspace right
    dconf:
      key: "/org/gnome/desktop/wm/keybindings/switch-to-workspace-right"
      value: "['<Super>Page_Down', '<Super><Alt>Right']"
  - name: Disable conflicting keyboard shortcut of GPaste
    dconf:
      key: "/org/gnome/GPaste/make-password"
      value: "''"
  - name: Set monoface font to 'Adwaita Mono' (The default)
    dconf:
      key: "/org/gnome/desktop/interface/monospace-font-name"
      value: '"Adwaita Mono 11"'
  - name: set font hinting to slight
    dconf:
      key: "/org/gnome/desktop/interface/font-hinting"
      value: "'slight'"
  - name: set antialiasing to rgba
    dconf:
      key: "/org/gnome/desktop/interface/font-antialiasing"
      value: "'rgba'"

- name: Install Gnome Extensions
  include_role:
    name: luizgavalda.gnome_extensions
  vars:
    gnome_extension_ids: [2236, 1070, 7048, 5470]

- name: Get all installed Gnome extensions
  find:
    paths: "{{ ansible_user_dir }}/.local/share/gnome-shell/extensions"
    file_type: directory
  register: installed_extensions

- name: Enable all installed Gnome extensions
  command: "gnome-extensions enable {{ item.path | basename }}"
  loop: "{{ installed_extensions.files }}"
  changed_when: false
